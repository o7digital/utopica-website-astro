# Lighthouse CI Setup Guide

## Overview

This document describes the Lighthouse CI and performance monitoring setup for the Utópica website, implemented as part of the Meridian Performance Plan Phase 6.2.

## Components

### 1. Lighthouse CI Configuration (`lighthouse.config.js`)
- Performance budgets and thresholds
- Multi-device testing (mobile/desktop)
- Resource budgets for scripts, images, CSS
- Accessibility and SEO requirements

### 2. GitHub Actions Workflows

#### `.github/workflows/lighthouse-ci.yml`
- Runs Lighthouse CI on every PR and push
- Tests multiple scenarios (mobile/desktop)
- Generates performance comparison reports
- Enforces performance budgets

#### `.github/workflows/performance.yml`
- Comprehensive performance testing suite
- Load testing capabilities
- Historical data tracking
- Production monitoring

### 3. Monitoring System

#### `scripts/lighthouse-monitoring.js`
- Continuous performance monitoring
- Alerting system for regressions
- Trend analysis and reporting
- Integration with external services

#### `scripts/performance-dashboard.js`
- Real-time performance dashboard
- Visual representation of metrics
- Historical trends visualization

## Usage

### Development

```bash
# Run performance audit
npm run lighthouse:performance

# Start monitoring
npm run lighthouse:monitor

# Generate dashboard
npm run performance:dashboard
```

### CI/CD

```bash
# Run Lighthouse CI
npm run lighthouse:ci

# Full CI performance suite
npm run ci:performance
```

### Production Monitoring

```bash
# Monitor production
npm run lighthouse:monitor:production

# View trends
npm run lighthouse:trends

# Check alerts
npm run lighthouse:alerts
```

## Performance Budgets

- **Performance Score**: ≥ 90
- **Accessibility Score**: ≥ 95
- **LCP**: ≤ 1.5s
- **CLS**: ≤ 0.1
- **FCP**: ≤ 1.2s
- **Total Bundle Size**: ≤ 1MB

## Alerting

The system generates alerts for:
- Performance score below 85 (critical) / 90 (warning)
- LCP above 2.5s (critical) / 2.0s (warning)
- CLS above 0.25 (critical) / 0.15 (warning)
- Accessibility score below 90 (critical) / 95 (warning)

## Integration

### GitHub Secrets Required
- `LHCI_GITHUB_APP_TOKEN`: For GitHub integration
- `LHCI_TOKEN`: For LHCI server (optional)

### Optional Alert Integrations
- `SLACK_WEBHOOK_URL`: Slack notifications
- `DISCORD_WEBHOOK_URL`: Discord notifications
- `ALERT_EMAIL`: Email alerts
- `PAGERDUTY_INTEGRATION_KEY`: PagerDuty integration

## Troubleshooting

### Common Issues

1. **Chrome not found in CI**
   - CI workflows automatically install Chrome
   - For local development, install Chrome or Chromium

2. **Performance budget failures**
   - Check the lighthouse reports in `lighthouse-reports/`
   - Review recommendations in the dashboard
   - Adjust budgets in `lighthouse.config.js` if needed

3. **Monitoring data not persisting**
   - Ensure `monitoring-data/` directory exists
   - Check file permissions
   - Verify disk space

### Getting Help

1. Check the GitHub Actions logs for detailed error messages
2. Review the generated lighthouse reports
3. Use the performance dashboard for visual debugging
4. Check the monitoring alerts for specific issues

## Maintenance

- Performance data is retained for 30 days by default
- Trends data is kept for 2 years
- Regular cleanup is performed automatically
- Update performance budgets as the site evolves

---

Generated by Lighthouse CI Setup Script
Last updated: 2025-07-27T06:28:58.155Z
